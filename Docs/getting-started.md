## 取扱説明書（YouTube運用支援ツール）

このツールは、YouTube の公開データを検索・閲覧し、結果やコメントを CSV 形式で保存するブラウザアプリケーションです。ログインは不要で、YouTube Data API v3 の API キーのみを使用します。

### 1. 機能
このツールでは、キーワードで動画を検索し、期間・国・最低再生数・ショート動画の扱い・登録者比のしきい値で対象を絞り込みます。結果一覧では、タイトル、チャンネル、再生数、登録者数（非公開の場合は「非公開」）、拡散率、いいね数、公開日、国を確認できます。必要に応じて動画コメントを取得し、動画一覧やコメントを CSV として保存できます。デスクトップでは表の見出しクリックで並び替えができ、モバイルではセレクターで並び替えができます。サムネイルをクリックすると拡大表示ができ、YouTube へのリンクを開けます。

### 2. 準備（YouTube API キー）
公開データ取得のために API キーを使用します。API キーはブラウザの localStorage に保存され、サーバへは送信されません。YouTube Data API には 1 日あたりの利用上限（クォータ）があり、上限に達すると当日は新たな取得ができません。API キーは必要に応じて再生成して差し替えられます。

API キーの取得手順:
1. `https://console.cloud.google.com/` にアクセスし、Google アカウントでログインします。
2. 画面上部のプロジェクト選択から新しいプロジェクトを作成します。
3. 左メニュー「API とサービス」→「ライブラリ」で「YouTube Data API v3」を有効化します。
4. 左メニュー「認証情報」→「認証情報を作成」→「API キー」を選択します。
5. 生成された API キーをコピーします。
6. 必要に応じて「API 制限」で「YouTube Data API v3」のみ許可に設定します（推奨）。

### 3. 使い方
1. アプリを開きます（デプロイ URL または `index.html` をブラウザで開きます）。
2. 画面上部の入力欄に API キーを貼り付けて「保存」を押します。正しく保存されると有効表示になります。
3. 検索条件を設定します。キーワード、対象期間、国、最低再生数、ショート動画の扱い、登録者比のしきい値、登録者数非公開チャンネルの扱いを指定できます（詳細は「4. 検索条件の意味」を参照）。
4. 「検索」を押すと取得を開始します。処理状況が画面に表示されます。
5. 結果一覧で各動画の情報を確認します。必要に応じて行内の「取得」ボタンでコメントを取得します。
6. CSV を保存する場合は、上部の「一覧 CSV 出力」で動画一覧を保存するか、行の「CSV」または「選択コメント CSV 出力」でコメントを保存します。
7. デスクトップでは表見出し（再生数/登録者数/拡散率/高評価/公開日）をクリックすると並び替えができます。モバイルでは一覧上部の並び替えセレクターを使用します。
8. サムネイルをクリックすると拡大画像が表示されます。拡大表示内のリンクから YouTube を開けます。ESC キーで閉じられます。

### 4. 検索条件の意味
- キーワード: 検索対象の語句です。未入力の場合はサンプル語句が使われます。
- 期間: 直近 6 か月/1 年/2 年/3 年のいずれかから選びます。
- 国: 対象チャンネルの国コードで絞り込みます（空欄は指定なし）。
- 最低再生数: この値以上の再生数を持つ動画のみを対象にします。
- ショート動画の扱い: 除外/含める/のみ から選びます。ショート判定は「2 分以内」またはショート関連タグの付与で判断します。
- 登録者比のしきい値: 再生数が登録者数の何倍以上かで判定します（例: 3 倍）。
- 登録者数非公開チャンネルを含める: 有効にすると最低再生数のみで判定します。無効の場合は「最低再生数」と「登録者比しきい値」の両方を満たす必要があります。

### 5. 結果画面の見方
- 再生数/登録者数/高評価/公開日/国: それぞれの指標を表示します。登録者数が非公開の場合は「非公開」と表示されます。
- 拡散率: 再生数 ÷ 登録者数 で算出します（登録者数が取得できない/非公開の場合は表示なし）。目安として、1 未満は赤、3 以上は緑で表示されます。
- Shorts バッジ: ショート動画と判定された場合に表示されます。
- 並び替え: 見出しのクリック（デスクトップ）またはセレクター（モバイル）で並び替えができます。見出しは再クリックで昇順/降順を切替え、3 回目で既定（再生数・降順）に戻ります。
- サムネイル拡大: 画像クリックで拡大表示。拡大画面から YouTube リンクを開けます。

### 6. CSV 出力
- 動画一覧 CSV: 画面上部の「↓ 一覧 CSV 出力」で保存します。主な列は次のとおりです。
  - `videoId`, `title`, `channelId`, `channelTitle`, `publishedAt`, `viewCount`, `subscriberCount`, `spreadRate`, `likeCount`, `country`, `videoUrl`, `thumbnailUrl`, `matchedRule`, `keywords`, `searchedAt`
- コメント CSV: 行の「↓ CSV」で個別動画、上部の「↓ 選択コメント CSV 出力」で選択した複数動画のコメントをまとめて保存します。

### 7. データとプライバシー
API キーと取得データはブラウザ内で保持され、サーバに保存されません。API キーを削除する場合は、入力欄を空にして保存するか、ブラウザのサイトデータを削除してください。

### 8. トラブル時の確認
エラーが出た場合は、API キーの入力誤りや未有効化、API 制限の設定を確認してください。クォータ上限に達していないかも確認してください。結果が得られない場合は、期間や最低再生数、登録者比、ショートの扱い、国指定などの条件を調整してください。
